星云科技内部开发规范

一、代码规范
1.1 命名规范
类名使用大驼峰命名（PascalCase），如：ChatServiceImpl、DocumentController。
方法名和变量名使用小驼峰命名（camelCase），如：chatWithAi、tenantId。
常量使用全大写下划线分隔，如：MAX_CONTEXT_CHARS、DEFAULT_TOP_K。

1.2 注释规范
所有公共类、方法需添加JavaDoc注释，说明功能、参数、返回值。复杂业务逻辑需添加行内注释。

1.3 代码格式
使用4个空格缩进，不使用Tab。每行代码不超过120个字符。方法之间空一行，类之间空两行。

二、Git工作流
2.1 分支管理
主分支为master，开发分支为develop。功能开发从develop创建feature分支，修复bug创建hotfix分支。

2.2 提交规范
提交信息格式：类型(范围): 描述。类型包括：feat（新功能）、fix（修复）、docs（文档）、style（格式）、refactor（重构）、test（测试）、chore（构建）。

2.3 代码审查
所有代码需经过至少一人审查后方可合并。审查重点：代码逻辑、性能、安全性、可维护性。

三、数据库规范
3.1 表设计
表名使用小写下划线分隔，如：chat_message、knowledge_document。字段名同样使用小写下划线分隔。

3.2 索引设计
主键使用自增ID，外键字段需建立索引。查询频繁的字段需建立索引，但避免过多索引影响写入性能。

3.3 数据迁移
数据库结构变更需编写迁移脚本，并在测试环境验证无误后再应用到生产环境。

四、API设计
4.1 RESTful规范
使用RESTful风格设计API，GET用于查询，POST用于创建，PUT用于更新，DELETE用于删除。

4.2 统一响应
所有API返回统一格式：{success, code, message, data}。成功时success为true，失败时success为false并返回错误码和错误信息。

4.3 版本管理
API版本通过URL路径管理，如：/api/v1/chat/ask。重大变更需升级版本号，保持旧版本兼容至少3个月。

五、测试规范
5.1 单元测试
所有业务逻辑需编写单元测试，测试覆盖率不低于80%。使用JUnit和Mockito框架。

5.2 集成测试
关键业务流程需编写集成测试，验证各模块协作正确性。集成测试在CI/CD流程中自动执行。

5.3 性能测试
涉及高并发的接口需进行性能测试，确保在预期负载下响应时间符合要求。

六、日志规范
6.1 日志级别
使用SLF4J日志框架，日志级别包括：DEBUG（调试）、INFO（信息）、WARN（警告）、ERROR（错误）。

6.2 日志内容
关键业务操作需记录INFO日志，异常情况记录ERROR日志。日志需包含：时间、线程、级别、类名、消息、异常堆栈。

6.3 日志管理
生产环境日志保留30天，开发环境保留7天。敏感信息（密码、token等）不得记录到日志。

七、安全规范
7.1 认证授权
所有API需进行JWT认证，敏感操作需进行权限校验。Token有效期设置为24小时，过期需重新登录。

7.2 数据校验
所有用户输入需进行校验，防止SQL注入、XSS攻击等。使用Spring Validation框架进行参数校验。

7.3 敏感信息
密码、API密钥等敏感信息不得硬编码，需存储在配置文件中并使用加密存储。


















