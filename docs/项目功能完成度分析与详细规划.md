# 多租户智能客服中台 - 项目功能完成度分析与详细规划

> **文档版本**: v2.0  
> **创建时间**: 2026-01-21  
> **项目状态**: 核心功能已实现，进入完善和优化阶段

---

## 📊 一、项目现状分析

### 1.1 已完成功能清单 ✅

#### 1.1.1 基础架构与认证
- ✅ **多租户架构**
  - 租户注册（B端/C端）
  - 租户隔离（TenantContextHolder）
  - 租户标识固定选择（EDU_001/002/003）
- ✅ **认证授权**
  - JWT Token认证
  - 角色权限（USER/ADMIN/AGENT）
  - 前端路由守卫
  - 后端权限注解（@RequireRole）

#### 1.1.2 AI对话能力
- ✅ **LLM集成**
  - 通义千问（Qwen）接入
  - LangChain4j集成
  - 多轮对话上下文管理
  - Redis上下文存储
- ✅ **RAG增强**
  - Qdrant向量数据库集成
  - DashScope Embedding服务
  - 文档向量化与索引
  - 语义检索与结果注入
  - 动态minScore调整
  - 引用文档展示

#### 1.1.3 知识库管理
- ✅ **文档管理**
  - 文档上传（支持txt/pdf/doc/docx/md）
  - Tika文档解析
  - 文档分块（Chunk）
  - 向量索引
  - 文档列表/详情/删除
- ✅ **检索服务**
  - 语义检索API
  - 租户隔离检索
  - 检索结果评分过滤

#### 1.1.4 会话管理
- ✅ **会话功能**
  - 会话创建/删除
  - 会话列表查询
  - 消息历史记录
  - 会话状态管理（正常/已删除）
- ✅ **消息管理**
  - 消息发送/接收
  - 消息持久化
  - 情绪识别（集成在LLM响应中）

#### 1.1.5 工单系统（基础）
- ✅ **工单功能**
  - 工单创建（基于负面情绪）
  - 工单列表查询
  - 工单状态流转
  - 工单分配
  - 工单评论
- ✅ **消息队列**
  - RabbitMQ集成
  - 事件发布/订阅
  - 异步工单创建

#### 1.1.6 通知中心
- ✅ **通知功能**
  - 通知列表查询
  - 通知已读标记
  - 通知创建（工单分配等）

#### 1.1.7 前端界面
- ✅ **C端（客户门户）**
  - 登录/注册页面
  - 对话页面（ChatPage）
  - FAQ页面（基础）
  - CustomerLayout布局
- ✅ **B端（管理后台）**
  - 登录/注册页面
  - 数据看板（AdminDashboardPage）
  - 工单列表（TicketListPage）
  - 会话管理（AdminSessionsPage）
  - 知识库管理（KnowledgePage）
  - 通知中心（NotifyCenterPage）
  - AdminLayout布局
- ✅ **UI组件**
  - Ant Design集成
  - 响应式布局
  - 路由导航

#### 1.1.8 基础设施
- ✅ **数据库**
  - MySQL数据库
  - MyBatis Plus ORM
  - 多租户数据隔离
- ✅ **缓存**
  - Redis集成
  - 上下文缓存
- ✅ **定时任务**
  - XXL-Job集成
  - 工单超时扫描

---

### 1.2 待完善功能清单 🔧

#### 1.2.1 转人工功能（部分完成）
- ⚠️ **当前状态**: 有转人工接口，但缺少完整流程
- 🔧 **需要完善**:
  - 转人工排队机制
  - 客服在线状态管理
  - 转人工通知推送
  - 转人工记录表
  - 转人工原因记录

#### 1.2.2 人工工作台（未实现）
- ❌ **缺失功能**:
  - 待接入会话列表
  - 会话接入功能
  - 实时对话窗口
  - 快捷回复库
  - 知识库快速查询
  - 会话转工单

#### 1.2.3 数据看板（基础完成，需增强）
- ⚠️ **当前状态**: 有基础统计接口
- 🔧 **需要完善**:
  - 实时数据刷新
  - 图表可视化（ECharts）
  - 趋势分析
  - 多维度统计
  - 数据导出

#### 1.2.4 FAQ页面（基础完成，需增强）
- ⚠️ **当前状态**: 有基础页面，但功能简单
- 🔧 **需要完善**:
  - FAQ分类管理
  - 关键词搜索
  - 热门问题推荐
  - FAQ点赞/反馈

#### 1.2.5 满意度评价（未实现）
- ❌ **缺失功能**:
  - 评价表单
  - 评价记录表
  - 评价统计
  - 评价反馈处理

---

### 1.3 待开发功能清单 🆕

#### 1.3.1 用户管理
- ❌ 客户列表查询
- ❌ 用户标签管理
- ❌ 用户画像
- ❌ 黑名单管理

#### 1.3.2 客服管理
- ❌ 客服列表
- ❌ 客服分组
- ❌ 在线状态管理
- ❌ 工作量统计

#### 1.3.3 系统配置
- ❌ AI模型配置
- ❌ 对话规则配置
- ❌ 转人工规则配置
- ❌ 通知配置

#### 1.3.4 统计分析（深度）
- ❌ 对话分析
- ❌ 工单分析
- ❌ 客服绩效分析
- ❌ 客户满意度分析

#### 1.3.5 其他功能
- ❌ 快捷回复模板管理
- ❌ 数据导出功能
- ❌ 消息已读状态
- ❌ WebSocket实时推送

---

## 🎯 二、详细功能规划

### 2.1 优先级P0：核心功能完善（2-3周）

#### 2.1.1 转人工功能完善 ⏱️ 3-5天

**目标**: 实现完整的转人工流程

**后端开发**:
1. **数据库表设计**
   ```sql
   CREATE TABLE `transfer_record` (
     `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
     `tenant_id` BIGINT NOT NULL,
     `session_id` BIGINT NOT NULL,
     `user_id` BIGINT NOT NULL,
     `agent_id` BIGINT COMMENT '接入的客服ID',
     `transfer_reason` VARCHAR(200) COMMENT '转人工原因',
     `status` VARCHAR(20) DEFAULT 'PENDING' COMMENT 'PENDING-待接入，ACCEPTED-已接入，CLOSED-已关闭',
     `create_time` DATETIME,
     `accept_time` DATETIME,
     KEY `idx_session` (`session_id`),
     KEY `idx_agent_status` (`agent_id`, `status`)
   );
   ```

2. **实体类与Mapper**
   - `TransferRecord` 实体
   - `TransferRecordMapper` 接口

3. **Service层**
   ```java
   public interface TransferService {
       // 转人工
       Long transferToAgent(Long sessionId, String reason);
       // 获取待接入列表
       List<TransferRecord> getPendingTransfers(Long tenantId);
       // 客服接入
       void acceptTransfer(Long transferId, Long agentId);
   }
   ```

4. **Controller层**
   ```java
   @PostMapping("/api/customer/chat/transfer")
   public ApiResponse<Long> transferToAgent(@RequestBody TransferRequest request);
   
   @GetMapping("/api/admin/workspace/pending-transfers")
   public ApiResponse<List<TransferRecord>> getPendingTransfers();
   
   @PostMapping("/api/admin/workspace/accept")
   public ApiResponse<Void> acceptTransfer(@RequestBody AcceptTransferRequest request);
   ```

**前端开发**:
1. **C端转人工按钮优化**
   - 添加转人工原因选择
   - 显示排队状态
   - 转人工成功提示

2. **B端待接入列表**
   - 显示待接入会话
   - 显示转人工原因
   - 一键接入按钮

**技术栈**:
- 后端: Spring Boot, MyBatis Plus
- 前端: React, Ant Design
- 数据库: MySQL

---

#### 2.1.2 人工工作台开发 ⏱️ 5-7天

**目标**: 为客服提供专业的工作界面

**页面布局**:
```
┌─────────────────────────────────────────┐
│  左侧：待接入会话列表  │  中间：对话窗口  │  右侧：快捷工具  │
│  - 待接入会话        │  - 消息列表     │  - 快捷回复     │
│  - 进行中会话        │  - 输入框       │  - 知识库查询   │
│  - 历史会话          │  - 转工单按钮   │  - 用户信息     │
└─────────────────────────────────────────┘
```

**后端开发**:
1. **工作台Service**
   ```java
   public interface WorkspaceService {
       // 获取待接入会话
       List<ChatSession> getPendingSessions(Long tenantId);
       // 获取进行中会话
       List<ChatSession> getActiveSessions(Long agentId);
       // 接入会话
       void acceptSession(Long sessionId, Long agentId);
       // 发送消息（客服）
       void sendAgentMessage(Long sessionId, String content, Long agentId);
       // 转工单
       Long transferToTicket(Long sessionId, String reason);
   }
   ```

2. **Controller层**
   ```java
   @RestController
   @RequestMapping("/api/admin/workspace")
   @RequireRole({"ADMIN", "AGENT"})
   public class WorkspaceController {
       @GetMapping("/pending-sessions")
       public ApiResponse<List<ChatSession>> getPendingSessions();
       
       @PostMapping("/accept")
       public ApiResponse<Void> acceptSession(@RequestBody AcceptSessionRequest request);
       
       @PostMapping("/send-message")
       public ApiResponse<Void> sendMessage(@RequestBody SendMessageRequest request);
   }
   ```

**前端开发**:
1. **WorkspacePage组件**
   - 三栏布局
   - 实时消息更新
   - 快捷回复选择
   - 知识库查询面板

2. **实时通信**（可选）
   - WebSocket集成
   - 消息推送
   - 在线状态

**技术栈**:
- 后端: Spring Boot, WebSocket（可选）
- 前端: React, Ant Design, WebSocket Client
- 数据库: MySQL

---

#### 2.1.3 数据看板增强 ⏱️ 3-5天

**目标**: 提供丰富的数据可视化

**后端开发**:
1. **DashboardService增强**
   ```java
   public interface DashboardService {
       // 实时统计
       DashboardStats getRealTimeStats(Long tenantId);
       // 趋势数据（7天/30天）
       TrendData getTrendData(Long tenantId, String period);
       // AI解决率
       AISolveRate getAISolveRate(Long tenantId, String period);
       // 工单统计
       TicketStats getTicketStats(Long tenantId, String period);
       // 满意度统计
       SatisfactionStats getSatisfactionStats(Long tenantId, String period);
   }
   ```

2. **数据缓存**
   - Redis缓存统计数据
   - 定时刷新（XXL-Job）

**前端开发**:
1. **图表组件**
   - 使用 ECharts 或 Recharts
   - 折线图（趋势）
   - 柱状图（对比）
   - 饼图（占比）
   - 卡片统计

2. **DashboardPage增强**
   - 实时数据刷新
   - 时间范围选择
   - 数据导出

**技术栈**:
- 后端: Spring Boot, Redis, XXL-Job
- 前端: React, ECharts/Recharts, Ant Design
- 数据库: MySQL

---

### 2.2 优先级P1：重要功能开发（3-4周）

#### 2.2.1 满意度评价系统 ⏱️ 3-5天

**数据库设计**:
```sql
CREATE TABLE `satisfaction_rating` (
  `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
  `tenant_id` BIGINT NOT NULL,
  `session_id` BIGINT NOT NULL,
  `user_id` BIGINT NOT NULL,
  `rating` TINYINT COMMENT '评分：1-5星',
  `comment` VARCHAR(500) COMMENT '评价内容',
  `create_time` DATETIME,
  KEY `idx_session` (`session_id`),
  KEY `idx_tenant_time` (`tenant_id`, `create_time`)
);
```

**后端开发**:
- `SatisfactionRating` 实体
- `SatisfactionService` 服务
- `POST /api/customer/chat/rate` 接口

**前端开发**:
- 评价弹窗组件
- 评价表单
- 评价历史查看

---

#### 2.2.2 FAQ功能增强 ⏱️ 3-5天

**数据库设计**:
```sql
CREATE TABLE `faq_item` (
  `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
  `tenant_id` BIGINT NOT NULL,
  `category` VARCHAR(50) COMMENT '分类',
  `title` VARCHAR(200) NOT NULL,
  `content` TEXT NOT NULL,
  `keywords` VARCHAR(500) COMMENT '关键词，逗号分隔',
  `view_count` INT DEFAULT 0,
  `like_count` INT DEFAULT 0,
  `status` TINYINT DEFAULT 1 COMMENT '1-发布，0-草稿',
  `create_time` DATETIME,
  `update_time` DATETIME,
  KEY `idx_tenant_category` (`tenant_id`, `category`)
);
```

**后端开发**:
- FAQ管理接口（CRUD）
- FAQ搜索接口
- 热门FAQ推荐

**前端开发**:
- FAQ分类浏览
- 搜索功能
- 热门问题推荐
- FAQ详情页

---

#### 2.2.3 用户管理模块 ⏱️ 5-7天

**功能点**:
- 客户列表查询（分页、搜索、筛选）
- 用户标签管理
- 用户画像（基于对话历史）
- 黑名单管理

**数据库设计**:
```sql
CREATE TABLE `user_tag` (
  `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
  `tenant_id` BIGINT NOT NULL,
  `user_id` BIGINT NOT NULL,
  `tag_name` VARCHAR(50) NOT NULL,
  `create_time` DATETIME,
  KEY `idx_user` (`user_id`)
);

CREATE TABLE `blacklist` (
  `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
  `tenant_id` BIGINT NOT NULL,
  `user_id` BIGINT NOT NULL,
  `reason` VARCHAR(200),
  `create_time` DATETIME,
  KEY `idx_user` (`user_id`)
);
```

---

#### 2.2.4 客服管理模块 ⏱️ 5-7天

**功能点**:
- 客服列表
- 客服分组
- 在线状态管理
- 工作量统计

**数据库设计**:
```sql
CREATE TABLE `agent_group` (
  `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
  `tenant_id` BIGINT NOT NULL,
  `group_name` VARCHAR(50) NOT NULL,
  `description` VARCHAR(200),
  `create_time` DATETIME
);

ALTER TABLE `user` ADD COLUMN `agent_group_id` BIGINT COMMENT '客服分组ID';
ALTER TABLE `user` ADD COLUMN `online_status` VARCHAR(20) DEFAULT 'OFFLINE' COMMENT '在线状态';
ALTER TABLE `user` ADD COLUMN `max_concurrent_sessions` INT DEFAULT 5 COMMENT '最大并发会话数';
```

---

### 2.3 优先级P2：增强功能（2-3周）

#### 2.2.5 系统配置模块 ⏱️ 5-7天

**功能点**:
- AI模型配置（切换模型、调整参数）
- 对话规则配置（欢迎语、结束语）
- 转人工规则配置（自动转人工条件）
- 通知配置（通知模板、通知渠道）

**数据库设计**:
```sql
CREATE TABLE `system_config` (
  `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
  `tenant_id` BIGINT NOT NULL,
  `config_key` VARCHAR(100) NOT NULL,
  `config_value` TEXT,
  `config_type` VARCHAR(50) COMMENT 'STRING/JSON/NUMBER/BOOLEAN',
  `description` VARCHAR(200),
  `update_time` DATETIME,
  UNIQUE KEY `uk_tenant_key` (`tenant_id`, `config_key`)
);
```

---

#### 2.2.6 统计分析模块 ⏱️ 7-10天

**功能点**:
- 对话分析（对话量、平均时长、关键词）
- 工单分析（工单量、处理时长、解决率）
- 客服绩效（响应时间、解决率、满意度）
- 客户满意度分析

**技术实现**:
- 数据聚合查询
- 定时任务统计（XXL-Job）
- 数据导出（Excel/CSV）

---

#### 2.2.7 快捷回复功能 ⏱️ 3-5天

**数据库设计**:
```sql
CREATE TABLE `quick_reply` (
  `id` BIGINT PRIMARY KEY AUTO_INCREMENT,
  `tenant_id` BIGINT NOT NULL,
  `category` VARCHAR(50) COMMENT '分类',
  `title` VARCHAR(100) NOT NULL,
  `content` TEXT NOT NULL,
  `use_count` INT DEFAULT 0,
  `create_time` DATETIME,
  `update_time` DATETIME,
  KEY `idx_tenant_category` (`tenant_id`, `category`)
);
```

**功能点**:
- 快捷回复模板管理
- 分类管理
- 使用统计
- 快速插入

---

## 🛠️ 三、技术栈清单

### 3.1 已使用技术栈 ✅

| 技术            | 用途      | 版本     |
| ------------- | ------- | ------ |
| **后端**        |         |        |
| Spring Boot   | 框架      | 2.7.18 |
| MyBatis Plus  | ORM     | 3.5.5  |
| MySQL         | 数据库     | 8.0+   |
| Redis         | 缓存/上下文  | 6.0+   |
| RabbitMQ      | 消息队列    | 3.8+   |
| LangChain4j   | AI集成    | 1.3.0  |
| Qdrant Client | 向量数据库   | 1.10.0 |
| Apache Tika   | 文档解析    | 2.9.1  |
| XXL-Job       | 定时任务    | 2.4.0  |
| Hutool        | 工具库     | 5.8.26 |
| **前端**        |         |        |
| React         | UI框架    | 18.2+  |
| TypeScript    | 类型安全    | 5.6+   |
| Ant Design    | UI组件库   | 5.19+  |
| React Router  | 路由管理    | 6.28+  |
| Axios         | HTTP客户端 | 1.7+   |
| Vite          | 构建工具    | 5.4+   |

### 3.2 需要新增技术栈 🆕

| 技术                   | 用途       | 优先级 | 说明        |
| -------------------- | -------- | --- | --------- |
| **ECharts/Recharts** | 数据可视化    | P0  | 数据看板图表    |
| **WebSocket**        | 实时通信     | P1  | 人工工作台实时消息 |
| **Apache POI**       | Excel导出  | P1  | 数据导出功能    |
| **Elasticsearch**    | 全文检索（可选） | P2  | FAQ高级搜索   |
| **Nginx**            | 反向代理     | P2  | 生产环境部署    |

---

## 📅 四、开发计划与时间线

### 阶段一：核心功能完善（3周）

**Week 1: 转人工功能完善**
- Day 1-2: 数据库设计 + 后端开发
- Day 3-4: 前端开发 + 联调
- Day 5: 测试 + 优化

**Week 2: 人工工作台开发**
- Day 1-2: 页面布局 + 后端接口
- Day 3-4: 前端组件开发
- Day 5: WebSocket集成（可选）+ 测试

**Week 3: 数据看板增强**
- Day 1-2: 后端统计接口
- Day 3-4: 前端图表集成
- Day 5: 缓存优化 + 测试

### 阶段二：重要功能开发（4周）

**Week 4: 满意度评价系统**
- Day 1-2: 数据库 + 后端
- Day 3-4: 前端开发
- Day 5: 测试

**Week 5: FAQ功能增强**
- Day 1-3: 后端开发
- Day 4-5: 前端开发

**Week 6-7: 用户管理与客服管理**
- Week 6: 用户管理模块
- Week 7: 客服管理模块

### 阶段三：增强功能（3周）

**Week 8: 系统配置模块**
- Day 1-3: 后端开发
- Day 4-5: 前端开发

**Week 9-10: 统计分析模块**
- Week 9: 后端统计逻辑
- Week 10: 前端可视化

**Week 11: 快捷回复功能**
- Day 1-3: 后端开发
- Day 4-5: 前端开发

---

## 🎯 五、关键里程碑

### Milestone 1: 转人工功能上线 ✅
- [ ] 转人工流程完整
- [ ] 待接入列表正常
- [ ] 客服接入功能正常

### Milestone 2: 人工工作台上线 ✅
- [ ] 工作台页面完成
- [ ] 实时消息正常
- [ ] 快捷回复可用

### Milestone 3: 数据看板增强 ✅
- [ ] 图表展示正常
- [ ] 数据实时刷新
- [ ] 数据导出功能

### Milestone 4: 满意度评价上线 ✅
- [ ] 评价功能完整
- [ ] 评价统计正常

### Milestone 5: 用户管理上线 ✅
- [ ] 用户列表正常
- [ ] 标签管理可用
- [ ] 黑名单功能正常

---

## 📝 六、开发注意事项

### 6.1 代码规范
- 遵循现有代码风格
- 使用统一的异常处理
- 完善日志记录
- 添加必要的注释

### 6.2 测试要求
- 单元测试（关键业务逻辑）
- 集成测试（API接口）
- 前端功能测试
- 多租户隔离测试

### 6.3 性能优化
- 数据库查询优化（索引）
- Redis缓存策略
- 前端懒加载
- 接口响应时间监控

### 6.4 安全考虑
- 权限校验（前后端）
- SQL注入防护
- XSS防护
- 敏感数据加密

---

## 🔄 七、迭代建议

### 迭代1（当前-2周后）
- ✅ 转人工功能完善
- ✅ 人工工作台基础功能
- ✅ 数据看板增强

### 迭代2（2-4周后）
- ✅ 满意度评价系统
- ✅ FAQ功能增强
- ✅ 用户管理基础功能

### 迭代3（4-6周后）
- ✅ 客服管理模块
- ✅ 系统配置模块
- ✅ 统计分析基础功能

### 迭代4（6-8周后）
- ✅ 统计分析增强
- ✅ 快捷回复功能
- ✅ 性能优化与测试

---

## 📚 八、参考文档

- [多租户智能客服中台-产品与技术架构设计.md](./多租户智能客服中台-产品与技术架构设计.md)
- [RAG实现方案-完整步骤与架构设计.md](./RAG实现方案-完整步骤与架构设计.md)
- [后端架构重构-详细实现指南.md](./后端架构重构-详细实现指南.md)
- [react-frontend-设计与实现指南.md](./react-frontend-设计与实现指南.md)

---

**文档维护**: 请根据项目进展及时更新此文档  
**最后更新**: 2026-01-21























