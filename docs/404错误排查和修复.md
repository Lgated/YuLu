# 404é”™è¯¯æ’æŸ¥å’Œä¿®å¤æŒ‡å—

## ğŸ” é—®é¢˜åˆ†æ

ä»é”™è¯¯ä¿¡æ¯çœ‹ï¼š
- **é”™è¯¯**ï¼š`POST http://localhost:5173/api/admin/auth/login 404 (Not Found)`
- **åŸå› **ï¼šè¯·æ±‚å‘é€åˆ°äº†å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆ5173ç«¯å£ï¼‰ï¼Œè€Œä¸æ˜¯åç«¯æœåŠ¡å™¨ï¼ˆ8080ç«¯å£ï¼‰

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. æ›´æ–°JWTè¿‡æ»¤å™¨æ’é™¤URLé…ç½®

**æ–‡ä»¶**ï¼š`src/main/java/com/ityfz/yulu/common/config/WebMvcConfig.java`

**ä¿®æ”¹å‰**ï¼š
```java
registration.addInitParameter("excludedUrls",
    "/api/auth/login," +
    "/api/auth/registerTenant," +
    "/actuator/health," +
    "/error");
```

**ä¿®æ”¹å**ï¼š
```java
registration.addInitParameter("excludedUrls",
    "/api/admin/auth/login," +
    "/api/admin/auth/registerTenant," +
    "/api/customer/auth/login," +
    "/api/customer/auth/register," +
    "/actuator/health," +
    "/error");
```

## ğŸ”§ å¯èƒ½çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆ

### åŸå› 1ï¼šViteä»£ç†é…ç½®æœªç”Ÿæ•ˆ

**æ£€æŸ¥**ï¼š`frontend/vite.config.ts` ä¸­çš„ä»£ç†é…ç½®

```typescript
export default defineConfig({
  plugins: [react()],
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true
      }
    }
  }
});
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **é‡å¯å‰ç«¯å¼€å‘æœåŠ¡å™¨**ï¼ˆé‡è¦ï¼ï¼‰
   ```bash
   # åœæ­¢å½“å‰æœåŠ¡å™¨ï¼ˆCtrl+Cï¼‰
   # é‡æ–°å¯åŠ¨
   cd frontend
   npm run dev
   ```

2. **æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ**
   ```bash
   # Windows PowerShell
   netstat -ano | findstr :8080
   # åº”è¯¥çœ‹åˆ° LISTENING çŠ¶æ€
   ```

### åŸå› 2ï¼šè·¨åŸŸé…ç½®é—®é¢˜

**æ£€æŸ¥**ï¼š`src/main/java/com/ityfz/yulu/common/config/WebMvcConfig.java`

è·¨åŸŸé…ç½®å·²æ­£ç¡®ï¼š
```java
@Override
public void addCorsMappings(CorsRegistry registry) {
    registry.addMapping("/**")
        .allowedOriginPatterns("*")
        .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
        .allowedHeaders("*")
        .allowCredentials(true)
        .maxAge(3600);
}
```

**æ³¨æ„**ï¼š404é”™è¯¯é€šå¸¸**ä¸æ˜¯è·¨åŸŸé—®é¢˜**ã€‚è·¨åŸŸé—®é¢˜ä¼šè¿”å›CORSé”™è¯¯ï¼Œè€Œä¸æ˜¯404ã€‚

### åŸå› 3ï¼šåç«¯è·¯ç”±æœªæ­£ç¡®æ³¨å†Œ

**æ£€æŸ¥**ï¼šç¡®è®¤åç«¯Controlleræ˜¯å¦æ­£ç¡®

**Bç«¯ç™»å½•**ï¼š`src/main/java/com/ityfz/yulu/admin/controller/AdminAuthController.java`
```java
@RestController
@RequestMapping("/api/admin/auth")
public class AdminAuthController {
    @PostMapping("/login")
    public ApiResponse<LoginResponse> login(@Valid @RequestBody LoginRequest request) {
        // ...
    }
}
```

**Cç«¯ç™»å½•**ï¼š`src/main/java/com/ityfz/yulu/customer/controller/CustomerAuthController.java`
```java
@RestController
@RequestMapping("/api/customer/auth")
public class CustomerAuthController {
    @PostMapping("/login")
    public ApiResponse<LoginResponse> login(@Valid @RequestBody CustomerLoginRequest request) {
        // ...
    }
}
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤1ï¼šæµ‹è¯•åç«¯æ¥å£ï¼ˆç›´æ¥è®¿é—®ï¼‰

```bash
# ä½¿ç”¨curlæµ‹è¯•ï¼ˆPowerShellï¼‰
curl.exe -X POST http://localhost:8080/api/admin/auth/login `
  -H "Content-Type: application/json" `
  -d '{\"tenantCode\":\"TENANT_001\",\"username\":\"admin\",\"password\":\"123456\"}'
```

**é¢„æœŸç»“æœ**ï¼š
- å¦‚æœè¿”å›JSONï¼ˆå³ä½¿æ˜¯é”™è¯¯ï¼‰ï¼Œè¯´æ˜è·¯ç”±å­˜åœ¨
- å¦‚æœè¿”å›404ï¼Œè¯´æ˜è·¯ç”±ä¸å­˜åœ¨æˆ–åç«¯æœªå¯åŠ¨

### æ­¥éª¤2ï¼šæ£€æŸ¥å‰ç«¯ä»£ç†

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ°"ç½‘ç»œ"ï¼ˆNetworkï¼‰æ ‡ç­¾
3. å°è¯•ç™»å½•
4. æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…ï¼š
   - **è¯·æ±‚URL**ï¼šåº”è¯¥æ˜¯ `http://localhost:5173/api/admin/auth/login`
   - **å®é™…ä»£ç†**ï¼šåº”è¯¥è½¬å‘åˆ° `http://localhost:8080/api/admin/auth/login`
   - **çŠ¶æ€ç **ï¼šå¦‚æœæ˜¯404ï¼Œæ£€æŸ¥ä»£ç†é…ç½®

### æ­¥éª¤3ï¼šæ£€æŸ¥åç«¯æ—¥å¿—

æŸ¥çœ‹åç«¯æ§åˆ¶å°è¾“å‡ºï¼Œç¡®è®¤ï¼š
- è¯·æ±‚æ˜¯å¦åˆ°è¾¾åç«¯
- æ˜¯å¦æœ‰è·¯ç”±åŒ¹é…é”™è¯¯
- æ˜¯å¦æœ‰å¼‚å¸¸æŠ›å‡º

## ğŸš€ å¿«é€Ÿä¿®å¤æ­¥éª¤

1. **ç¡®è®¤åç«¯æœåŠ¡è¿è¡Œ**
   ```bash
   # æ£€æŸ¥8080ç«¯å£
   netstat -ano | findstr :8080
   ```

2. **é‡å¯å‰ç«¯å¼€å‘æœåŠ¡å™¨**
   ```bash
   cd frontend
   # åœæ­¢å½“å‰æœåŠ¡å™¨ï¼ˆCtrl+Cï¼‰
   npm run dev
   ```

3. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**
   - æŒ‰ `Ctrl+Shift+R` å¼ºåˆ¶åˆ·æ–°
   - æˆ–æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

4. **æ£€æŸ¥ç½‘ç»œè¯·æ±‚**
   - æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
   - æŸ¥çœ‹Networkæ ‡ç­¾
   - ç¡®è®¤è¯·æ±‚URLå’Œå“åº”çŠ¶æ€

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæ˜¯404è€Œä¸æ˜¯CORSé”™è¯¯ï¼Ÿ

**A**: 404è¡¨ç¤ºè·¯ç”±ä¸å­˜åœ¨ï¼Œé€šå¸¸æ˜¯å› ä¸ºï¼š
- ä»£ç†é…ç½®æœªç”Ÿæ•ˆï¼ˆéœ€è¦é‡å¯å‰ç«¯æœåŠ¡å™¨ï¼‰
- åç«¯è·¯ç”±æœªæ­£ç¡®æ³¨å†Œ
- è¯·æ±‚URLæ‹¼å†™é”™è¯¯

### Q2: ä»£ç†é…ç½®æ­£ç¡®ï¼Œä½†è¿˜æ˜¯404ï¼Ÿ

**A**: æ£€æŸ¥ï¼š
1. åç«¯æœåŠ¡æ˜¯å¦çœŸçš„åœ¨è¿è¡Œ
2. åç«¯Controlleræ˜¯å¦è¢«Springæ‰«æåˆ°ï¼ˆæ£€æŸ¥åŒ…è·¯å¾„ï¼‰
3. åç«¯æ˜¯å¦æœ‰å…¶ä»–è¿‡æ»¤å™¨/æ‹¦æˆªå™¨é˜»æ­¢äº†è¯·æ±‚

### Q3: å¦‚ä½•ç¡®è®¤ä»£ç†æ˜¯å¦ç”Ÿæ•ˆï¼Ÿ

**A**: 
1. æŸ¥çœ‹æµè§ˆå™¨Networkæ ‡ç­¾ä¸­çš„è¯·æ±‚è¯¦æƒ…
2. æŸ¥çœ‹åç«¯æ—¥å¿—ï¼Œç¡®è®¤è¯·æ±‚æ˜¯å¦åˆ°è¾¾
3. ä½¿ç”¨curlç›´æ¥æµ‹è¯•åç«¯æ¥å£

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `frontend/vite.config.ts` - Viteä»£ç†é…ç½®
- `frontend/src/api/axios.ts` - Axiosé…ç½®
- `frontend/src/api/auth.ts` - è®¤è¯APIè°ƒç”¨
- `src/main/java/com/ityfz/yulu/common/config/WebMvcConfig.java` - è·¨åŸŸå’Œè¿‡æ»¤å™¨é…ç½®
- `src/main/java/com/ityfz/yulu/admin/controller/AdminAuthController.java` - Bç«¯ç™»å½•Controller
- `src/main/java/com/ityfz/yulu/customer/controller/CustomerAuthController.java` - Cç«¯ç™»å½•Controller

---

**æœ€åæ›´æ–°**ï¼š2026-01-14

















